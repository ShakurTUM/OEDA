<div class="row">
  <!--Target System Selection, Description, Details Button, Status, Create Experiment Button-->
  <div class="col-md-12">
    <div class="panel panel-default chartJs">
      <div class="panel-heading">
        <div class="card-title">
          <div class="title pull-left">Target System Selection</div>
          <div class="pull-right">
            <div *ngIf="hasChanges() && !hasErrors() && !hasErrorsAnalysis()" (click)="saveExperiment()" class="btn btn-sm btn-orange"><i
              class="fa fa-send"></i> Create Experiment
            </div>
            <div *ngIf="hasChanges() && hasErrors()" class="btn btn-m btn-danger"><i
              class="fa fa-close"></i> {{errorButtonLabel}}
            </div>
          </div>
        </div>
      </div>
      <div class="panel-body" *ngIf="availableTargetSystems.length > 0" style="padding-top: 20px">
        <div class="row">
          <div class="col-md-3">
            <div class="sub-title">Name</div>
            <div>
                <select class="form-control" required (change)="targetSystemChanged($event.target.value)">
                  <option disabled>Select target system</option>
                  <option *ngFor="let i of availableTargetSystems;" [ngValue]="i">{{ i.name }}</option>
                </select>
            </div>
          </div>

          <div class="col-md-4" *ngIf="targetSystem.name !== ''">
            <div class="sub-title">Description</div>
            <span>{{targetSystem.description}}</span>
          </div>

          <div class="col-md-3" *ngIf="targetSystem.name !== ''">
            <div class="sub-title">Details</div>
            <button type="button" class="btn btn-orange"
                    (click)="is_collapsed = !is_collapsed">
              <span *ngIf="is_collapsed">Show Details</span>
              <i *ngIf="is_collapsed" class="fa fa-angle-double-down" aria-hidden="true"></i>

              <span *ngIf="!is_collapsed">Hide Details</span>
              <i *ngIf="!is_collapsed" class="fa fa-angle-double-up" aria-hidden="true"></i>
            </button>
          </div>

          <div class="col-md-2" *ngIf="targetSystem.name !== ''">
            <div class="sub-title">Status</div>
            <label *ngIf="targetSystem.status == 'READY'" class="label label-success">READY</label>
            <label *ngIf="targetSystem.status == 'WORKING'" class="label label-info">WORKING</label>
            <label *ngIf="targetSystem.status == 'ERROR'" class="label label-danger">ERROR</label>
          </div>
        </div>
      </div>
      <div class="panel-body" *ngIf="availableTargetSystems.length == 0" style="padding-top: 20px">
        <div class="row">
          <div class="col-md-6">
            <div class="sub-title">There is no available target system
              <a (click)="navigateToTargetSystemPage()"> please create one here </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--Experiment Parameters-->
  <div class="col-md-12" *ngIf="targetSystem.name !== ''">
    <div class="panel panel-default chartJs">
      <div class="panel-heading">
        <div class="card-title">
          <div class="title pull-left">Experiment Parameters</div>
        </div>
      </div>
      <div class="panel-body">
        <div class="row">
          <labeled-input name="Experiment Name (required)" [model]="experiment" key="name" [colSize]="6"
                         tooltipTitle="Please provide a unique name"></labeled-input>
          <labeled-input name="Experiment Description" [model]="experiment" key="description" [required]="false" [colSize]="6"></labeled-input>
        </div>
      </div>
    </div>
  </div>

  <!-- Primary Data Provider & Secondary Data Provider(s) & Default variables -->
  <div class="col-md-12" *ngIf="targetSystem.name !== ''" [hidden]="is_collapsed"
       style="border-radius: 25px; border: 2px solid #73AD21;">

    <!-- Primary Data Provider -->
    <div class="col-sm-6" style="padding-left: 0">
      <div class="panel panel-default chartJs">
        <div class="panel-heading">
          <div class="card-title">
            <div class="title pull-left">Primary Data Provider</div>
          </div>
        </div>
        <div class="panel-body" style="padding-top: 20px">
          <div class="row" *ngIf="targetSystem.primaryDataProvider.type == 'http_request'">
            <div class="col-md-3">
              <div class="sub-title">Name</div>
              <span>{{targetSystem.primaryDataProvider.name}}</span>
            </div>
            <div class="col-md-2">
              <div class="sub-title">URL</div>
              <span>{{targetSystem.primaryDataProvider.url}}</span>
            </div>
            <div class="col-md-2">
              <div class="sub-title">Port</div>
              <span>{{targetSystem.primaryDataProvider.port}}</span>
            </div>
            <div class="col-md-3">
              <div class="sub-title">Serializer</div>
              <span>{{targetSystem.primaryDataProvider.serializer}}</span>
            </div>
            <div class="col-md-2">
              <div class="sub-title">Ignore First N Samples</div>
              <span>{{targetSystem.primaryDataProvider.ignore_first_n_samples}}</span>
            </div>
          </div>

          <div class="row" *ngIf="targetSystem.primaryDataProvider.type == 'kafka_consumer'">
            <div class="col-md-3">
              <div class="sub-title">Name</div>
              <span>{{targetSystem.primaryDataProvider.name}}</span>
            </div>
            <div class="col-md-2">
              <div class="sub-title">Kafka URI</div>
              <span>{{targetSystem.primaryDataProvider.kafka_uri}}</span>
            </div>
            <div class="col-md-2">
              <div class="sub-title">Topic</div>
              <span>{{targetSystem.primaryDataProvider.topic}}</span>
            </div>
            <div class="col-md-3">
              <div class="sub-title">Serializer</div>
              <span>{{targetSystem.primaryDataProvider.serializer}}</span>
            </div>
            <div class="col-md-2">
              <div class="sub-title">Ignore First N Samples</div>
              <span>{{targetSystem.primaryDataProvider.ignore_first_n_samples}}</span>
            </div>
          </div>

          <div class="row" *ngIf="targetSystem.primaryDataProvider.type == 'mqtt_listener'">
            <div class="col-md-2">
              <div class="sub-title">Name</div>
              <span>{{targetSystem.primaryDataProvider.name}}</span>
            </div>
            <div class="col-md-3">
              <div class="sub-title">Host</div>
              <span>{{targetSystem.primaryDataProvider.host}}</span>
            </div>
            <div class="col-md-2">
              <div class="sub-title">Port</div>
              <span>{{targetSystem.primaryDataProvider.port}}</span>
            </div>
            <div class="col-md-2">
              <div class="sub-title">Topic</div>
              <span>{{targetSystem.primaryDataProvider.topic}}</span>
            </div>
            <div class="col-md-1">
              <div class="sub-title">Serializer</div>
              <span>{{targetSystem.primaryDataProvider.serializer}}</span>
            </div>
            <div class="col-md-2">
              <div class="sub-title">Ignore First N Samples</div>
              <span>{{targetSystem.primaryDataProvider.ignore_first_n_samples}}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Secondary Data Provider(s) -->
      <div class="panel panel-default chartJs" *ngIf="targetSystem.secondaryDataProviders.length > 0">
        <div class="panel-heading">
          <div class="card-title">
            <div class="title pull-left" *ngIf="targetSystem.secondaryDataProviders.length > 1">Secondary Data Providers</div>
            <div class="title pull-left" *ngIf="targetSystem.secondaryDataProviders.length == 1">Secondary Data Provider</div>
          </div>
        </div>
        <div class="panel-body" style="padding-top: 20px">
          <div class="row" *ngFor="let secondaryDataProvider of targetSystem.secondaryDataProviders">
            <div *ngIf="secondaryDataProvider.type == 'http_request'">
              <div class="col-md-3">
                <div class="sub-title">Name</div>
                <span>{{secondaryDataProvider.name}}</span>
              </div>
              <div class="col-md-3">
                <div class="sub-title">URL</div>
                <span>{{secondaryDataProvider.url}}</span>
              </div>
              <div class="col-md-3">
                <div class="sub-title">Port</div>
                <span>{{secondaryDataProvider.port}}</span>
              </div>
              <div class="col-md-3">
                <div class="sub-title">Serializer</div>
                <span>{{secondaryDataProvider.serializer}}</span>
              </div>
            </div>

            <div *ngIf="secondaryDataProvider.type == 'kafka_consumer'">
              <div class="col-md-3">
                <div class="sub-title">Name</div>
                <span>{{secondaryDataProvider.name}}</span>
              </div>
              <div class="col-md-3">
                <div class="sub-title">Kafka URI</div>
                <span>{{secondaryDataProvider.kafka_uri}}</span>
              </div>
              <div class="col-md-3">
                <div class="sub-title">Topic</div>
                <span>{{secondaryDataProvider.topic}}</span>
              </div>
              <div class="col-md-3">
                <div class="sub-title">Serializer</div>
                <span>{{secondaryDataProvider.serializer}}</span>
              </div>
            </div>

            <div *ngIf="secondaryDataProvider.type == 'mqtt_listener'">
              <div class="col-md-2">
                <div class="sub-title">Name</div>
                <span>{{secondaryDataProvider.name}}</span>
              </div>
              <div class="col-md-3">
                <div class="sub-title">Host</div>
                <span>{{secondaryDataProvider.host}}</span>
              </div>
              <div class="col-md-3">
                <div class="sub-title">Port</div>
                <span>{{secondaryDataProvider.port}}</span>
              </div>
              <div class="col-md-3">
                <div class="sub-title">Topic</div>
                <span>{{secondaryDataProvider.topic}}</span>
              </div>
              <div class="col-md-1">
                <div class="sub-title">Serializer</div>
                <span>{{secondaryDataProvider.serializer}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Change Provider -->
    <div class="col-sm-6" style="padding-right: 0">
      <div class="panel panel-default chartJs">
        <div class="panel-heading">
          <div class="card-title">
            <div class="title pull-left">Change Provider</div>
          </div>
        </div>
        <div class="panel-body" style="padding-top: 20px">

          <div class="row" *ngIf="targetSystem.changeProvider.type == 'http_request'">
            <div class="col-md-4">
              <div class="sub-title">URL</div>
              <span>{{targetSystem.changeProvider.url}}</span>
            </div>
            <div class="col-md-4">
              <div class="sub-title">Port</div>
              <span>{{targetSystem.changeProvider.port}}</span>
            </div>
            <div class="col-md-4">
              <div class="sub-title">Serializer</div>
              <span>{{targetSystem.changeProvider.serializer}}</span>
            </div>
          </div>

          <div class="row" *ngIf="targetSystem.changeProvider.type == 'kafka_producer'">
            <div class="col-md-4">
              <div class="sub-title">Kafka URI</div>
              <span>{{targetSystem.changeProvider.kafka_uri}}</span>
            </div>
            <div class="col-md-4">
              <div class="sub-title">Topic</div>
              <span>{{targetSystem.changeProvider.topic}}</span>
            </div>
            <div class="col-md-4">
              <div class="sub-title">Serializer</div>
              <span>{{targetSystem.changeProvider.serializer}}</span>
            </div>
          </div>

          <div class="row" *ngIf="targetSystem.changeProvider.type == 'mqtt_listener'">
            <div class="col-md-3">
              <div class="sub-title">Host</div>
              <span>{{targetSystem.changeProvider.host}}</span>
            </div>
            <div class="col-md-3">
              <div class="sub-title">Port</div>
              <span>{{targetSystem.changeProvider.port}}</span>
            </div>
            <div class="col-md-3">
              <div class="sub-title">Topic</div>
              <span>{{targetSystem.changeProvider.topic}}</span>
            </div>
            <div class="col-md-3">
              <div class="sub-title">Serializer</div>
              <span>{{targetSystem.changeProvider.serializer}}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Default Variables -->
    <div class="col-sm-12" style="padding-right: 0; padding-left: 0">
      <div class="panel panel-default chartJs">
        <div class="panel-heading">
          <div class="card-title">
            <div class="title pull-left">Default variables of Target System</div>
          </div>
        </div>
        <div class="panel-body" style="padding-top: 20px">
          <div class="table-responsive">
            <table class="table table-striped table-bordered table-hover">
              <thead>
                <th>Name</th>
                <th>Min</th>
                <th>Max</th>
                <th>Default Value</th>
              </thead>
              <tbody>
                <tr *ngFor="let changeableVariable of targetSystem.defaultVariables" style="padding-top: 1%">
                  <td>{{changeableVariable.name}}</td>
                  <td>{{changeableVariable.min}}</td>
                  <td>{{changeableVariable.max}}</td>
                  <td>{{changeableVariable.default}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Incoming Data Types -->
  <div class="col-md-12" *ngIf="targetSystem.name !== ''">
    <div class="panel panel-default chartJs">
      <div class="panel-heading">
        <div class="card-title">
          <div class="title pull-left">Incoming Data Types</div>
        </div>
      </div>
      <div class="panel-body" style="padding-top: 20px">
        <div class="table-responsive">
          <table class="table table-striped table-bordered table-hover">
            <thead>
              <th style="padding-left: 1%">Name</th>
              <th style="padding-left: 1%">Scale</th>
              <th style="padding-left: 1%">Description</th>
              <th style="padding-left: 1%">Data Provider Name</th>
              <th style="padding-left: 1%">Data Provider Type</th>
              <th style="padding-left: 1%">Optimization Criteria</th>
              <th style="padding-left: 1%">Consider</th>
              <th *ngIf="is_data_type_selected()" style="padding-left: 1%">Aggregation</th>
              <th *ngIf="is_data_type_selected()" style="padding-left: 1%">Weight</th>
            </thead>
            <tbody>
            <tr *ngFor="let dataType of targetSystem.incomingDataTypes; let i = index" style="padding-top: 1%">
              <td>{{dataType.name}}</td>
              <td>{{dataType.scale}}</td>
              <td>{{dataType.description}}</td>
              <td>{{dataType.dataProviderName}}</td>
              <td *ngIf="is_data_type_coming_from_primary(i)">Primary</td> <td *ngIf="!is_data_type_coming_from_primary(i)">Secondary</td>
              <td>{{dataType.criteria}}</td>
              <td *ngIf="is_data_type_coming_from_primary(i)">
                <input type="checkbox" class="form-check-input"
                       (change)="data_type_checkbox_clicked(i)"
                       data-toggle="tooltip"
                       title="Select one incoming data type to be optimized. You cannot aggregate data coming from primary & secondary data providers at the same time">
              </td>
              <td *ngIf="dataType['is_considered'] && dataType.scale == 'Metric'">
                <select [(ngModel)]="dataType['aggregateFunction']" required>
                  <option *ngFor="let fcn of aggregateFunctionsMetric" [ngValue]="fcn.key">{{fcn.label}}</option>
                </select>
              </td>
              <td *ngIf="dataType['is_considered'] && dataType.scale == 'Boolean'">
                <select [(ngModel)]="dataType['aggregateFunction']" required>
                  <option *ngFor="let fcn of aggregateFunctionsBoolean" [ngValue]="fcn.key">{{fcn.label}}</option>
                </select>
              </td>
              <td *ngIf="dataType['is_considered']">
                <input type="number" class="form-check-input"
                       data-toggle="tooltip"
                       title="Please provide weight of this data type within the final result"
                       [(ngModel)]="dataType['weight']"
                       [min]="1"
                       [max]="100"
                       required>
                <span *ngIf="dataType['aggregateFunction'] !== 'percentiles'"><b>%</b></span>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Analysis, Execution Strategy -->
  <div class="col-md-12" *ngIf="targetSystem.name !== ''">

    <!-- Analysis -->
    <div class="col-md-6" style="padding-left: 0">
      <div class="panel panel-default chartJs">
        <div class="panel-heading">
          <div class="card-title">
            <div class="title pull-left">Analysis</div>
            <div class="title pull-right">
              <a data-toggle="modal" data-target="#analysisModal"><i class="fa fa-info fa-lg"></i></a>
            </div>
          </div>
        </div>
        <div class="panel-body" style="padding-top: 20px">
          <labeled-input-select name="Type" [model]="experiment.analysis" key="type" [colSize]="6"
                                [options]="[
                                    {key:'t_test',label:'T-Test'},
                                    {key:'anova',label:'Analysis of Variance'},
                                    {key:'bayesian_opt',label:'Bayesian Optimization'},
                                    {key:'no_analysis', label:'Do not perform analysis tests'}]"
                                (modelChanged)="analysisTypeChanged($event)">
          </labeled-input-select>
          <div *ngIf="experiment.analysis.type == 't_test'">
            <labeled-input-select name="Specific Method" [model]="experiment.analysis" key="method" [colSize]="6"
                                  [options]="[
                                    {key:'one_factor_two_values',label:'1 Factor & 2 Values'},
                                    {key:'two_factors_one_value',label:'2 Factors & 1 Value'}]"
                                  (modelChanged)="analysisMethodChanged($event)">
            </labeled-input-select>
          </div>

          <div *ngIf="experiment.analysis.type == 'anova'">
            <labeled-input inputType="number" name="Number of Factors"
                           [model]="experiment.analysis" key="n" [colSize]="6"
                           [minNumber]="1"
                           [maxNumber]="targetSystem.changeableVariables.length"
                           tooltipTitle='Number of experiments to be passed to n-sample tests. It must be less than or equal to number of changeable variables of the target system and greater than 1'>
            </labeled-input>
          </div>

          <div *ngIf="experiment.analysis.type == 'anova' || experiment.analysis.type == 't_test'">
            <labeled-input inputType="number" name="Alpha"
                           [model]="experiment.analysis" key="alpha" [colSize]="6"
                           [minNumber]="0"
                           [maxNumber]="1"
                           tooltipTitle='Alpha value that will be used as significance threshold for analysis phase'>
            </labeled-input>

            <labeled-input-select name="Data Type" [model]="experiment.analysis" key="data_type" [colSize]="6"
                                  [options]="data_types_for_analysis"
                                  (modelChanged)="analysisDataTypeChanged($event)">
            </labeled-input-select>

          </div>

          <div *ngIf="experiment.analysis.type == 'bayesian_opt'">
            <labeled-input-select name="Specific Method" [model]="experiment.analysis" key="inner_type" [colSize]="6"
                                  [options]="[
                                    {key:'mlr_mbo',label:'mlrMBO'},
                                    {key:'self_optimizer',label:'Self Optimizer Strategy'},
                                    {key:'uncorrelated_self_optimizer',label:'Uncorrelated Self Optimizer Strategy'}]"
                                  (modelChanged)="analysisMethodChanged($event)">
            </labeled-input-select>
          </div>
        </div>
      </div>
    </div>

    <!-- Execution Strategy -->
    <div class="col-md-6" style="padding-right: 0" *ngIf="experiment.analysis.type !== undefined">
      <div class="panel panel-default chartJs">
        <div class="panel-heading">
          <div class="card-title">
            <div class="title pull-left">Execution Strategy</div>
            <div class="title pull-right">
              <a data-toggle="modal" data-target="#infoModal"><i class="fa fa-info fa-lg"></i></a>
            </div>
          </div>
        </div>
        <div class="panel-body">
          <!-- Show regular executionStrategy fields if no analysis is specified -->
          <labeled-input-select *ngIf="experiment.analysis.type=='no_analysis'" name="Type" [model]="experiment.executionStrategy" key="type" [colSize]="6"
                                [options]="[
                                    {key:'step_explorer',label:'Step Strategy'},
                                    {key:'self_optimizer',label:'Self Optimizer Strategy'},
                                    {key:'uncorrelated_self_optimizer',label:'Uncorrelated Self Optimizer Strategy'},
                                    {key:'mlr_mbo',label:'mlrMBO Strategy'},
                                    {key:'forever',label:'Forever Strategy'},
                                    {key:'sequential',label:'Sequential Strategy'}]"
                                tooltipTitle="Defines the experimentation process"
                                (modelChanged)="executionStrategyModelChanged($event)">
          </labeled-input-select>

          <labeled-input-select *ngIf="experiment.executionStrategy.type == 'self_optimizer' || experiment.executionStrategy.type == 'uncorrelated_self_optimizer'"
                                name="Acquisition Method" [model]="experiment.executionStrategy" key="acquisition_method" [colSize]="6"
                                [options]="[
                                  {key:'LCB',label:'Lower Confidence Bound'},
                                  {key:'EI',label:'Negative Expected Improvement'},
                                  {key:'PI',label:'Negative Probability of Improvement'},
                                  {key:'gp_hedge',label:'Choosing one of the three above at each iteration'},
                                  {key:'EIps',label:'Negated Expected Improvement per second'},
                                  {key:'PIps',label:'Negated Probability of Improvement per second'}]"
                                (modelChanged)="acquisitionMethodChanged($event)"></labeled-input-select>

          <labeled-input-select *ngIf="experiment.executionStrategy.type == 'mlr_mbo'"
                                name="Acquisition Method" [model]="experiment.executionStrategy" key="acquisition_method" [colSize]="6"
                                [options]="[
                                  {key:'ei',label:'Expected Improvement'},
                                  {key:'mr',label:'Mean Error'},
                                  {key:'se',label:'Standard Error'},
                                  {key:'cb',label:'Confidence Bound'},
                                  {key:'aei',label:'Augmented Expected Improvement'},
                                  {key:'eqi',label:'Expected Quantile Improvement'}]"
                                (modelChanged)="acquisitionMethodChanged($event)"></labeled-input-select>

          <labeled-input *ngIf="experiment.executionStrategy.type == 'mlr_mbo' ||
                                experiment.executionStrategy.type == 'self_optimizer' ||
                                experiment.executionStrategy.type == 'uncorrelated_self_optimizer'"
                         inputType="number" name="Optimizer Iterations" [model]="experiment.executionStrategy" key="optimizer_iterations" [colSize]="6" [minNumber]="1" (modelChanged)="strategyParametesChanged($event)"></labeled-input>
          <labeled-input *ngIf="experiment.executionStrategy.type == 'mlr_mbo' ||
                                experiment.executionStrategy.type == 'self_optimizer' ||
                                experiment.executionStrategy.type == 'uncorrelated_self_optimizer'"
                         inputType="number" name="Optimizer Iterations in Design" [model]="experiment.executionStrategy" key="optimizer_iterations_in_design" [colSize]="6" [minNumber]="0" (modelChanged)="strategyParametesChanged($event)"></labeled-input>
          <labeled-input inputType="number" name="Sample Size" [model]="experiment.executionStrategy" key="sample_size" [colSize]="6" [minNumber]="1" tooltipTitle='Number of samples to be collected from each experiment'></labeled-input>

          <div *ngIf="experiment.executionStrategy.type !== 'forever' && stages_count !== null">
            <div class="col-md-6">
              <div class="sub-title">Total Number of Stages</div>
              <div>
                <input class="form-control" type="number" [disabled]="true" [value]=stages_count>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Selection among Changeable Variables if user has selected "No Analysis" option-->
    <div class="col-md-12" style="padding-left: 0; padding-right: 0" *ngIf="targetSystem.name !== ''
                                              && experiment.executionStrategy.type !== 'forever'
                                              && experiment.executionStrategy.type.length !== 0
                                              && experiment.analysis.type === 'no_analysis'">
      <div class="panel panel-default chartJs">
        <div class="panel-heading">
          <div class="card-title">
            <div class="title pull-left">Changeable Variables</div>
          </div>
        </div>
        <div class="panel-body">
          <div class="table-responsive">
            <table class="table table-striped table-bordered table-hover">
              <thead>
                <th>Name</th>
                <th>Scale</th>
                <th>Description</th>
                <th>Min</th>
                <th>Max</th>
                <th>Default</th>
                <th *ngIf="experiment.executionStrategy.type=='sequential' || experiment.executionStrategy.type=='step_explorer'">Select</th>
                <th *ngIf="is_changeable_variable_selected(null) && experiment.executionStrategy.type=='sequential'">Experiment Value</th>
                <th *ngIf="is_changeable_variable_selected(null) && experiment.executionStrategy.type=='step_explorer'">Step</th>
              </thead>
              <tbody>
              <tr *ngFor="let changeableVariable of targetSystem.changeableVariables; let i = index" style="padding-top: 1%">
                <td>{{changeableVariable.name}}</td>
                <td>{{changeableVariable.scale}}</td>
                <td>{{changeableVariable.description}}</td>
                <td>{{changeableVariable.min}}</td>
                <td>{{changeableVariable.max}}</td>
                <td>{{changeableVariable.default}}</td>
                <td *ngIf="experiment.executionStrategy.type=='sequential' || experiment.executionStrategy.type=='step_explorer'">
                  <input type="checkbox" class="form-check-input"
                         (change)="changeable_variable_checkbox_clicked(i)" data-toggle="tooltip"
                         title="Select changeable variable(s) suitable for the analysis">
                </td>
                <td *ngIf="is_changeable_variable_selected(i) && experiment.executionStrategy.type=='sequential'">
                  <input type="number" class="form-check-input"
                         data-toggle="tooltip"
                         title="Please provide target value for this variable to be used in the process"
                         [(ngModel)]="changeableVariable['target']"
                         [min]="changeableVariable.min"
                         [max]="changeableVariable.max"
                         required>
                </td>
                <td *ngIf="is_changeable_variable_selected(i) && experiment.executionStrategy.type=='step_explorer'">
                  <input type="number" class="form-check-input"
                         data-toggle="tooltip"
                         title="Please provide step value for this variable to be used in the process"
                         [(ngModel)]="changeableVariable['step']"
                         [min]="changeableVariable.min"
                         [max]="changeableVariable.max"
                         required>
                </td>
                <td *ngIf="is_changeable_variable_valid(i)">
                  <div class="btn btn-xs btn-orange" (click)="addChangeableVariable(changeableVariable)"
                       *ngIf="targetSystem.changeableVariables.length > 0 ">
                    <i class="fa fa-plus push-5-r"></i> Add
                  </div>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
          <div class="btn btn-xs btn-orange pull-right" *ngIf="experiment.executionStrategy.type === 'sequential' && targetSystem.changeableVariables.length > 0"
               (click)="addVariablesFor2FactorAndSeqTest()">
            <i class="fa fa-plus push-5-r"></i> Add as Configuration
          </div>
        </div>
      </div>
    </div>

    <!-- Selection among Changeable Variables if user has selected an Analysis option-->
    <div class="col-md-12" style="padding-left: 0; padding-right: 0" *ngIf="targetSystem.name !== ''
                                              && experiment.executionStrategy.type !== 'forever'
                                              && experiment.executionStrategy.type.length !== 0
                                              && experiment.analysis.type !== 'no_analysis'
                                              && showVariables()">
      <div class="panel panel-default chartJs">
        <div class="panel-heading">
          <div class="card-title">
            <div class="title pull-left">Changeable Variables</div>
            <div *ngIf="hasErrorsAnalysis()" class="pull-right btn btn-xs btn-danger"><i
              class="fa fa-close"></i> {{errorButtonLabelChangeableVariables}}
            </div>
          </div>
        </div>
        <div class="panel-body" style="padding-top: 20px">
          <div class="table-responsive">
            <table class="table table-striped table-bordered table-hover">
              <thead>
                <th style="padding-left: 1%">Name</th>
                <th style="padding-left: 1%">Scale</th>
                <th style="padding-left: 1%">Description</th>
                <th style="padding-left: 1%">Experiment Min</th>
                <th style="padding-left: 1%">Experiment Max</th>
                <th style="padding-left: 1%">Default</th>
                <th style="padding-left: 1%" *ngIf="experiment.analysis.type=='t_test' || experiment.analysis.type=='anova'">Select</th>
                <th style="padding-left: 1%" *ngIf="is_changeable_variable_selected(null) && experiment.analysis.type=='t_test'">Experiment Value</th>
                <th style="padding-left: 1%" *ngIf="is_changeable_variable_selected(null) && experiment.analysis.type=='anova'">Step</th>
                <th style="padding-left: 1%" *ngIf="(is_changeable_variable_selected(null) && (experiment.analysis.method == 'one_factor_two_values' || experiment.analysis.type =='anova'))
                                        || experiment.analysis.type =='bayesian_opt'">Action</th>
              </thead>
              <tbody>
              <tr *ngFor="let changeableVariable of targetSystem.changeableVariables; let i = index" style="padding-top: 1%">
                <td>{{changeableVariable.name}}</td>
                <td>{{changeableVariable.scale}}</td>
                <td>{{changeableVariable.description}}</td>
                <td>{{changeableVariable.min}}</td>
                <td>{{changeableVariable.max}}</td>
                <td>{{changeableVariable.default}}</td>
                <td *ngIf="experiment.analysis.type=='t_test' || experiment.analysis.type=='anova'">
                  <input type="checkbox" class="form-check-input"
                         (change)="changeable_variable_checkbox_clicked(i)" data-toggle="tooltip"
                         title="Select changeable variable(s) suitable for the analysis">
                </td>
                <td *ngIf="is_changeable_variable_selected(i) && experiment.analysis.type=='t_test'">
                  <input type="number" class="form-check-input"
                         data-toggle="tooltip"
                         title="Please provide experiment value for this variable to be used in the analysis"
                         [(ngModel)]="changeableVariable['target']"
                         [min]="changeableVariable.min"
                         [max]="changeableVariable.max"
                         required>
                </td>
                <td *ngIf="is_changeable_variable_selected(i) && experiment.analysis.type=='anova'">
                  <input type="number" class="form-check-input"
                         data-toggle="tooltip"
                         title="Please provide step size for this variable to be used in anova analysis. If you want to do analysis with lower and upper bounds of the variable(s), set step size to Max - Min"
                         [(ngModel)]="changeableVariable['step']"
                         [min]="changeableVariable.min"
                         [max]="changeableVariable.max"
                         required>
                </td>
                <td *ngIf="(is_changeable_variable_selected(i) && (experiment.analysis.method == 'one_factor_two_values' || experiment.analysis.type =='anova'))
                                        || experiment.analysis.type =='bayesian_opt'">
                  <div class="btn btn-xs btn-orange" (click)="addChangeableVariable(changeableVariable)">
                    <i class="fa fa-plus push-5-r"></i> Add
                  </div>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
          <div class="btn btn-xs btn-orange pull-right" *ngIf="experiment.analysis.method === 'two_factors_one_value' && targetSystem.changeableVariables.length > 0 && !hasErrors2FactorAndSequential()"
               (click)="addVariablesFor2FactorAndSeqTest()">
              <i class="fa fa-plus push-5-r"></i> Add as Configuration
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Added Variables -->
  <div class="col-md-12" *ngIf="targetSystem.name !== ''
                                && experiment.executionStrategy.type !== 'forever'
                                && experiment.executionStrategy.type.length !== 0
                                && experiment.changeableVariables.length > 0">
    <div class="panel panel-default chartJs">
      <div class="panel-heading">
        <div class="card-title">
          <div class="title pull-left">Configuration (Click 'Show Details' at top of this page for default values of other variables) </div>
          <div class="pull-right">
            <div class="btn btn-xs btn-primary" (click)="removeAllVariables()"
                 *ngIf="targetSystem.changeableVariables.length > 1 && experiment.changeableVariables.length > 1">
              <i class="fa fa-remove"></i> Remove All
            </div>
          </div>
        </div>
      </div>

      <!-- Regular changeable variable summary, structure of experiment.changeableVariables is [ [knob, knob, knob], [knob] ]-->
      <div class="panel-body" style="padding-top: 20px" *ngIf="experiment.changeableVariables.length > 0">
        <div class="row" style="padding-left: 1%" *ngFor="let knobArr of experiment.changeableVariables; let i = index">
            <div class="row" *ngFor="let knobKey of get_keys(knobArr)">
              <labeled-input name="Name" [model]="knobArr[knobKey]" key="name" [colSize]="3" disabled="true"></labeled-input>
              <span *ngIf="experiment.analysis.type == 'no_analysis' || experiment.analysis.type == 'bayesian_opt'">
                <labeled-input inputType="number" name="Experiment Min" [model]="knobArr[knobKey]" key="min" [colSize]="2" (modelChanged)="strategyParametesChanged($event)"></labeled-input>
                <labeled-input inputType="number" name="Experiment Max" [model]="knobArr[knobKey]" key="max" [colSize]="2" (modelChanged)="strategyParametesChanged($event)"></labeled-input>
                <labeled-input inputType="number" name="Default" [model]="knobArr[knobKey]" key="default" [colSize]="2" disabled="true"></labeled-input>
                <labeled-input *ngIf="experiment.executionStrategy.type == 'sequential'" inputType="number" name="Experiment Value" [model]="knobArr[knobKey]" key="target" [colSize]="2"></labeled-input>
                <labeled-input *ngIf="experiment.executionStrategy.type == 'step_explorer'" inputType="number" name="Step Size" [model]="knobArr[knobKey]" key="step" [colSize]="2" (modelChanged)="strategyParametesChanged($event)"></labeled-input>
                <labeled-input-select *ngIf="experiment.executionStrategy.type == 'step_explorer'" name="Steps" [model]="knobArr[knobKey]" key="levels" [options]="knobArr[knobKey]['levels']" [colSize]="3" [disabled]=true></labeled-input-select>
              </span>

              <span *ngIf="experiment.analysis.type == 't_test' || experiment.analysis.type == 'anova'">
                <labeled-input inputType="number" name="Experiment Min" [model]="knobArr[knobKey]" key="min" [colSize]="2" disabled="true" (modelChanged)="strategyParametesChanged($event)"></labeled-input>
                <labeled-input inputType="number" name="Experiment Max" [model]="knobArr[knobKey]" key="max" [colSize]="2" disabled="true" (modelChanged)="strategyParametesChanged($event)"></labeled-input>
                <labeled-input inputType="number" name="Default" [model]="knobArr[knobKey]" key="default" [colSize]="2" disabled="true"></labeled-input>
                <labeled-input *ngIf="experiment.analysis.method == 'one_factor_two_values' || experiment.analysis.method == 'two_factors_one_value'" inputType="number" name="Experiment Value" [model]="knobArr[knobKey]" key="target" [colSize]="2" disabled="true"></labeled-input>
                <labeled-input *ngIf="experiment.analysis.type == 'anova'" inputType="number" name="Step Size" [model]="knobArr[knobKey]" key="step" [colSize]="2" disabled="true"></labeled-input>
                <labeled-input-select *ngIf="experiment.analysis.type == 'anova'" name="Levels" [model]="knobArr[knobKey]" key="levels" [options]="knobArr[knobKey]['levels']" [colSize]="3" [disabled]=true></labeled-input-select>
              </span>

            </div>
            <div class="col-sm-1">
              <div class="sub-title">
                <div>
                  <div (click)="removeChangeableVariable(i)" class="btn btn-xs btn-primary"><i class="fa fa-remove"></i> Remove</div>
                </div>
              </div>
            </div>
            <hr class="col-md-12">
        </div>
      </div>
    </div>
  </div>

   <!--Default Configuration of target system if strategy is forever (TO BE REMOVED) -->
  <div class="col-md-12" *ngIf="targetSystem.name !== '' && experiment.executionStrategy.type === 'forever' && experiment.executionStrategy.type.length !== 0">
    <div class="panel panel-default chartJs">
      <div class="panel-heading">
        <div class="card-title">
          <div class="title pull-left">Default Configuration of {{targetSystem.name}}</div>
        </div>
      </div>
      <div class="panel-body" style="padding-top: 20px">
        <div class="row" *ngFor="let input of targetSystem.defaultVariables">
          <labeled-input name="Name" [model]="input" key="name" [colSize]="3" disabled="true"></labeled-input>
          <labeled-input inputType="number" name="Value" [model]="input" key="default" [colSize]="3" [minNumber]="input.min" [maxNumber]="input.max"></labeled-input>
        </div>
      </div>

    </div>

  </div>

  <!-- Info modal for Execution Strategies -->
  <div class="modal fade bd-example-modal-sm" id="infoModal" tabindex="-1" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="col-md-12">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title" id="modalTitle">Execution Strategies</h3>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>Execution strategies define the experimentation process, i.e. specify how multiple
              experiments are to be performed.</p>
            <p>OEDA supports following strategies:</p>
            <hr>
            <p><b>Step: </b>Goes through the specified ranges of changeable variables</p>
            <hr>

            <p><b>Self Optimizer: </b>Runs multiple experiments and tries to find the best value for the knobs
              using <a target="_blank" href="http://scikit-learn.org">scikit-learn's</a> Bayesian optimization with Gaussian Processes</p>
            <hr>

            <p><b>Uncorrelated Self Optimizer:</b>Instead of finding best values for all knobs at the same time,
              it tries to find the best value for one variable at each experimentation</p>
            <hr>

            <p><b>mlr MBO:</b> Optimizes expensive black-box functions by model-based optimization
              using  <a target="_blank" href="https://mlr-org.github.io/mlrMBO/articles/mlrMBO.html">mlrMBO</a> that is based on machine learning library written in R</p>
            <hr>

            <p><b>Forever: </b>Uses default values of the selected target system and runs the experimentation process forever</p>
            <hr>

            <p><b>Sequential: </b>Runs a list of experiments one after another</p>
            <hr>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Info modal for Analysis Types -->
  <div class="modal fade bd-example-modal-sm" id="analysisModal" tabindex="-1" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="col-md-12">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title" id="analysisModalTitle">Analysis Types</h3>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>Different types of analysis can be performed (i) to test a statistical hypothesis or (ii) to optimize output of experiments with respect to different criteria</p>
            <p>OEDA supports following analysis types</p>
            <hr>

            <p>
              <b><a target="_blank" href="https://www.investopedia.com/terms/t/t-test.asp">T-test:</a></b>
              Analysis of two populations means through the use of statistical examination
              testing the difference between the samples when the variances of two normal distributions are not known.
            </p>
            <hr>

            <p>
              <b><a target="_blank" href="https://en.wikipedia.org/wiki/Analysis_of_variance">Analysis of Variance(ANOVA):</a></b>
              Collection of statistical models and their associated procedures
              (such as "variation" among and between groups) used to analyze the differences among group means
            </p>
            <hr>

            <p>
              <b><a target="_blank" href="https://en.wikipedia.org/wiki/Bayesian_optimization">Bayesian Optimization</a></b>
              Design strategy for global optimization of black-box functions, i.e. objective function is unknown.
              Bayesian optimization is well suited for functions that are very expensive to evaluate.
            </p>
            <hr>

            <p>
              You can also choose not to specify an analysis type. In this case you need to choose execution strategies yourself and provide necessary parameters accordingly.
            </p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <debug-element [element]="experiment"></debug-element>
  <debug-element [element]="targetSystem"></debug-element>
</div>
